<html>

<head>
    <title>Gamifica requisitos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
</head>

<body>
    <h1>Real Time Database</h1>

    <u1 id="usersList"></u1>
    <hr>
    
    <div class="col-md-4">
        <form>
            <div class="form-group">
                <label for="nameInput">Name</label>
                <input type="text" class="form-control" id="nameInput" placeholder="Name">
            </div>
            <div class="form-group">
                <label for="ageInput">Age</label>
                <input type="number" class="form-control" id="ageInput" placeholder="Age">
            </div>
            <button class="btn btn-lg btn-block btn-primary" id="addButton">Add</button>
        </form>
    </div>

    <br><br>
    <a href="index.html">Back</li>
        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
            const firebaseConfig = {
                apiKey: "AIzaSyA224zrzRZ7Iy7rrNRE9dWCUs-Kr23ktiE",
                authDomain: "disciplinareq.firebaseapp.com",
                databaseURL: "https://disciplinareq-default-rtdb.firebaseio.com",
                projectId: "disciplinareq",
                storageBucket: "disciplinareq.appspot.com",
                messagingSenderId: "292130692921",
                appId: "1:292130692921:web:29ab9b610e1c220d5652e8",
                measurementId: "G-FLC6D2WGBC"
            };
            const app = initializeApp(firebaseConfig);

            import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";
            const db = getDatabase(app);
            var nameInput = document.getElementById('nameInput');
            var ageInput = document.getElementById('ageInput');
            var addButton = document.getElementById('addButton');
            var usersList = document.getElementById('usersList');
            addButton.addEventListener(
                'click',
                function () {
                    create(nameInput.value, ageInput.value)
                }
            )
            function create(name, age) {
                var data = {
                    name: name,
                    age: age
                }
                return push(ref(db, 'users'), data);
            }
            onValue(ref(db, 'users'), (snapshot) => {
                usersList.innerHTML = '';
                snapshot.forEach((item) => {
                    var li = document.createElement('li');
                    li.appendChild(document.createTextNode(item.val().name + ': ' + item.val().age));
                    usersList.appendChild(li);
                });
            });
        </script>
</body>

</html>